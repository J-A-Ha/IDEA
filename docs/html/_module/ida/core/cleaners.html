<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ida.core.cleaners &mdash; IDA 0.01 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            IDA
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">ida</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">IDA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">ida.core.cleaners</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for ida.core.cleaners</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Functions for parsing, cleaning, and normalising data.&quot;&quot;&quot;</span>

<span class="c1"># Importing packages</span>

<span class="kn">from</span> <span class="nn">..datasets</span> <span class="kn">import</span> <span class="n">stopwords</span><span class="p">,</span> <span class="n">html_stopwords</span> 

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Tuple</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">selectolax.parser</span> <span class="kn">import</span> <span class="n">HTMLParser</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">requests_html</span>
<span class="kn">from</span> <span class="nn">requests_html</span> <span class="kn">import</span> <span class="n">HTML</span>

<span class="kn">from</span> <span class="nn">nltk.tokenize</span> <span class="kn">import</span> <span class="n">word_tokenize</span><span class="p">,</span> <span class="n">sent_tokenize</span>



<div class="viewcode-block" id="join_list_by_semicolon"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.join_list_by_semicolon">[docs]</a><span class="k">def</span> <span class="nf">join_list_by_semicolon</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Joins the items of a list into a string connected by semicolons. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        
        <span class="k">return</span> <span class="s1">&#39;; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">item</span></div>

<div class="viewcode-block" id="join_df_col_lists_by_semicolon"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.join_df_col_lists_by_semicolon">[docs]</a><span class="k">def</span> <span class="nf">join_df_col_lists_by_semicolon</span><span class="p">(</span><span class="n">dataframe</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces the lists in a Dataframe with strings connected by semicolons. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">dataframe</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">join_list_by_semicolon</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">dataframe</span></div>

<div class="viewcode-block" id="strip_list_str"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.strip_list_str">[docs]</a><span class="k">def</span> <span class="nf">strip_list_str</span><span class="p">(</span><span class="n">list_item</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes string. If it is formatted as a Python list, splits it and cleans it. Returns it as a list object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">list_item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        
        <span class="n">list_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">list_item</span><span class="p">)</span>
        <span class="n">list_series</span> <span class="o">=</span> <span class="n">list_series</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">list_series</span> <span class="o">=</span> <span class="n">list_series</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;NaN&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">list_series</span> <span class="o">=</span> <span class="n">list_series</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">clean_list</span> <span class="o">=</span> <span class="n">list_series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># </span>
        <span class="k">return</span> <span class="n">clean_list</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Item must be a string&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="text_cleaner"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.text_cleaner">[docs]</a><span class="k">def</span> <span class="nf">text_cleaner</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">replace</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">n&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">&#39;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes string and removes inputted characters.&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="n">replace</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">character</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="remove_stopwords"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.remove_stopwords">[docs]</a><span class="k">def</span> <span class="nf">remove_stopwords</span><span class="p">(</span>
                    <span class="n">words_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> 
                     <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;English&#39;</span><span class="p">,</span> 
                     <span class="n">stopwords_list</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> 
                     <span class="n">min_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> 
                     <span class="n">max_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> 
                     <span class="n">ignore_case</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> 
                     <span class="n">retain_order</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes a sequence of strings and checks if the string is in a list of stopwords. Returns a list object with the strings removed.</span>
<span class="sd">    </span>
<span class="sd">    Users can select a list of stopwords from the stopwords object. Defaults to &#39;all&#39; stopwords.</span>
<span class="sd">    Users can opt-in to retain the order of the words using the &#39;retain_order&#39; parameter.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Importing stopwords object into the environment</span>
    <span class="k">global</span> <span class="n">stopwords</span>
    
    <span class="k">if</span> <span class="n">stopwords_list</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">to_remove</span> <span class="o">=</span> <span class="n">stopwords</span><span class="p">[</span><span class="n">stopwords_list</span><span class="p">]</span>
    
    <span class="k">else</span><span class="p">:</span>
        
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">stopwords_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">to_remove</span> <span class="o">=</span> <span class="n">stopwords_list</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">language</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;english&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">language</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;en&#39;</span><span class="p">):</span>
                <span class="n">to_remove</span> <span class="o">=</span> <span class="n">stopwords</span><span class="p">[</span><span class="s1">&#39;en&#39;</span><span class="p">]</span>
    
    <span class="c1"># Conducting some data cleaning</span>
    <span class="n">to_remove</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">to_remove</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">object</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
    
    <span class="n">words_list_cleaned</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">words_list</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">object</span><span class="p">)</span>
    <span class="n">words_list_cleaned</span> <span class="o">=</span> <span class="n">words_list_cleaned</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;!&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;“&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;”&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">words_list_cleaned</span> <span class="o">=</span> <span class="n">words_list_cleaned</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">words_list_cleaned</span> <span class="o">=</span> <span class="n">words_list_cleaned</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="n">ignore_case</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">words_list_cleaned</span> <span class="o">=</span> <span class="n">words_list_cleaned</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        
    <span class="n">words_list_cleaned</span> <span class="o">=</span> <span class="n">words_list_cleaned</span><span class="p">[(</span><span class="n">words_list_cleaned</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">min_length</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">words_list_cleaned</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">max_length</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">words_list_cleaned</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">words_list_cleaned</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">words_list_cleaned</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)]</span>
    <span class="n">words_list_cleaned</span> <span class="o">=</span> <span class="n">words_list_cleaned</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
    
    <span class="n">words_list_joined</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">words_list_cleaned</span><span class="p">)</span>
    <span class="n">words_list_joined</span> <span class="o">=</span> <span class="n">words_list_joined</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">words_list_cleaned</span> <span class="o">=</span> <span class="n">words_list_joined</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    
    
    <span class="c1"># Converting lists into sets</span>
    <span class="n">remove_words_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">to_remove</span><span class="p">)</span>
    <span class="n">wordslist_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">words_list_cleaned</span><span class="p">)</span>
    
    <span class="c1"># Identifying words to be removed and retained</span>
    <span class="n">to_remove</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">wordslist_set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">remove_words_set</span><span class="p">))</span>
    <span class="n">to_retain</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">wordslist_set</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">remove_words_set</span><span class="p">))</span>
    
    <span class="c1"># Returning set difference if &#39;retain_order&#39; parameter is set to False.</span>
    <span class="k">if</span> <span class="n">retain_order</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">to_retain</span>
    
    <span class="k">else</span><span class="p">:</span>
    
    <span class="c1"># Creating list of strings *not* in the stopwords list. Takes advantage of Pandas&#39; serialisation.</span>
        <span class="n">words_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">words_list_cleaned</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;word&#39;</span><span class="p">])</span>
        <span class="n">words_df_lowered</span> <span class="o">=</span> <span class="n">words_df</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">words_df_lowered</span><span class="p">[</span><span class="s1">&#39;word&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">words_df_lowered</span><span class="p">[</span><span class="s1">&#39;word&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        
        <span class="n">drop_indexes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">to_remove</span><span class="p">:</span>
            <span class="n">indexes_to_remove</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">words_df_lowered</span><span class="p">[</span><span class="n">words_df_lowered</span><span class="p">[</span><span class="s1">&#39;word&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">word</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="n">drop_indexes</span> <span class="o">=</span> <span class="n">drop_indexes</span> <span class="o">+</span> <span class="n">indexes_to_remove</span>
            
        <span class="n">words_df</span> <span class="o">=</span> <span class="n">words_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">drop_indexes</span><span class="p">)</span>
        <span class="n">result_list</span> <span class="o">=</span> <span class="n">words_df</span><span class="p">[</span><span class="s1">&#39;word&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
        <span class="n">result_joined</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result_list</span><span class="p">)</span>
        <span class="n">result_joined</span> <span class="o">=</span> <span class="n">result_joined</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result_joined</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">result</span></div>
        

<div class="viewcode-block" id="html_words_cleaner"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.html_words_cleaner">[docs]</a><span class="k">def</span> <span class="nf">html_words_cleaner</span><span class="p">(</span><span class="n">words_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">to_remove</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">ignore_case</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">retain_order</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes a sequence of strings and checks if the string is in a list of html stopwords. Returns a list object with the strings removed.</span>
<span class="sd">    </span>
<span class="sd">    Users can select a list of stopwords from the stopwords object. Defaults to html stopwords.</span>
<span class="sd">    Users can opt-in to retain the order of the strings using the &#39;retain_order&#39; parameter.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># By default, selecting the &#39;html&#39; stopwords list</span>
    <span class="k">if</span> <span class="n">to_remove</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="k">global</span> <span class="n">stopwords</span>
        <span class="n">to_remove</span> <span class="o">=</span> <span class="s1">&#39;html&#39;</span>
    
    <span class="c1"># Conducting data cleaning</span>
    <span class="n">words_joined</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">words_list</span><span class="p">)</span>
    <span class="n">words_joined</span> <span class="o">=</span> <span class="n">words_joined</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;{&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">split_words</span> <span class="o">=</span> <span class="n">words_joined</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    
    <span class="c1"># Removing stopwords</span>
    <span class="n">output_list</span> <span class="o">=</span> <span class="n">remove_stopwords</span><span class="p">(</span><span class="n">split_words</span><span class="p">,</span> <span class="n">stopwords_list</span> <span class="o">=</span> <span class="n">to_remove</span><span class="p">,</span> <span class="n">min_length</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">ignore_case</span><span class="o">=</span> <span class="n">ignore_case</span><span class="p">,</span> <span class="n">retain_order</span> <span class="o">=</span> <span class="n">retain_order</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">output_list</span></div>


<div class="viewcode-block" id="html_extract_all_words"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.html_extract_all_words">[docs]</a><span class="k">def</span> <span class="nf">html_extract_all_words</span><span class="p">(</span><span class="n">html</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;request_input&#39;</span><span class="p">,</span> <span class="n">to_remove</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">ignore_case</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">retain_order</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes html as a string object and extracts words. Returns as a list object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># By default, requests user to input html string</span>
    <span class="k">if</span> <span class="n">html</span> <span class="o">==</span> <span class="s1">&#39;request_input&#39;</span><span class="p">:</span>
        <span class="n">html</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;HTML to parse: &#39;</span><span class="p">)</span>
    
    <span class="c1"># Tokenizing html</span>
    <span class="n">html_tokenized</span> <span class="o">=</span> <span class="n">word_tokenize</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
    
    <span class="c1"># Cleaning html and extracting words</span>
    <span class="n">html_words</span> <span class="o">=</span> <span class="n">html_words_cleaner</span><span class="p">(</span><span class="n">words_list</span> <span class="o">=</span> <span class="n">html_tokenized</span><span class="p">,</span> <span class="n">to_remove</span> <span class="o">=</span> <span class="n">to_remove</span><span class="p">,</span> <span class="n">ignore_case</span> <span class="o">=</span> <span class="n">ignore_case</span><span class="p">,</span> <span class="n">retain_order</span> <span class="o">=</span> <span class="n">retain_order</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">html_words</span></div>


<div class="viewcode-block" id="text_splitter"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.text_splitter">[docs]</a><span class="k">def</span> <span class="nf">text_splitter</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parse_by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">replace</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">n&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">&#39;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes text as a string object, cleans it, and splits it into a set of strings depending on symbols given. Returns as a list object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        
        <span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="n">replace</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">character</span><span class="p">,</span> <span class="n">parse_by</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">parse_by</span><span class="p">)</span>
        
        <span class="n">split_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">element</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">element</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">split_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>

                
        <span class="k">return</span> <span class="n">split_data</span>
    
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span></div>
    

<div class="viewcode-block" id="html_get_tags"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.html_get_tags">[docs]</a><span class="k">def</span> <span class="nf">html_get_tags</span><span class="p">(</span><span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes html as a string object and extracts tags. Returns as a list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Cleaning and splitting data</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">data_split</span> <span class="o">=</span> <span class="n">text_splitter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">parse_by</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    
    
    <span class="c1"># Extracting tags</span>
    <span class="n">tags</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data_split</span><span class="p">:</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">):</span>
                <span class="n">tags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    
    
    <span class="n">tags</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">tags</span></div>

<div class="viewcode-block" id="get_text_selectolax"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.get_text_selectolax">[docs]</a><span class="k">def</span> <span class="nf">get_text_selectolax</span><span class="p">(</span><span class="n">html</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes html as a string object and returns the text it contains.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    
    <span class="n">tree</span> <span class="o">=</span> <span class="n">HTMLParser</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">tree</span><span class="o">.</span><span class="n">body</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">css</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">):</span>
        <span class="n">tag</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">css</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">):</span>
        <span class="n">tag</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>

    <span class="n">text</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">separator</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">text</span></div>


<div class="viewcode-block" id="html_text_cleaner"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.html_text_cleaner">[docs]</a><span class="k">def</span> <span class="nf">html_text_cleaner</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes html as a string; removes unwanted characters and strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">stripwords</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
    
        <span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;imprint ads&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;javascript is not available&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;javascript is disabled&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;enable javascript&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;supported browsers&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;supported browser&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;cookie policy&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/div&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;layer layer&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;function&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;cookie&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;page path&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;true);&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ua-&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;a llow&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;allow&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;d eveloper&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Developer&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;developer&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;placehol der&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;anonymize ip&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;;function&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;push(arguments)&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;datalayer&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:false&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ad personalization&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;page location&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;placeholder&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;window.data&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;window.datalayer&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;window.dataLayer&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;latest news&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Organization Structure&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Agenda&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\0</span><span class="s1">Tweets&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;mx-1&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; b &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;EN&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;tooltip&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;gtag&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;id.&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:true&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; js &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;bottom=&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;title=&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">xa0&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;xa0&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;style=&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;page_placeholder&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;class=&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;toggle&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;data-&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;a0&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">x&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;href=&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;site map&quot;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Sites Map&quot;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;sites map&quot;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;contact us&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Contact Us&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;about us&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;About Us&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;sitemap&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">item</span>
    
    
    <span class="k">def</span> <span class="nf">stripchars</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        
        <span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ); &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;); &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ) &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ( &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; . &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ,&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">t&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">n&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">n&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;b</span><span class="se">\&#39;</span><span class="s1"> &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">t&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">n&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">n&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;b</span><span class="se">\&#39;</span><span class="s1"> &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ; &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ;&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; : &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;{&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;()&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; s &#39;</span><span class="p">,</span> <span class="s2">&quot;&#39;s &quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">item</span>
    
    <span class="k">def</span> <span class="nf">stripspace</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        
        <span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;   &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;     &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;       &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        
        <span class="k">return</span> <span class="n">item</span>
    
    <span class="n">text</span> <span class="o">=</span> <span class="n">stripwords</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">stripchars</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">stripspace</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">stripwords</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">stripchars</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">stripspace</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">text</span></div>

<div class="viewcode-block" id="get_words_list"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.get_words_list">[docs]</a><span class="k">def</span> <span class="nf">get_words_list</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">min_length</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">lower</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes text as a string and returns a list of words.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Removing leading and trailing whitespaces</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    
    <span class="c1"># Replacing punctuation prior to splitting</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; -&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;!&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    
    <span class="c1"># Splitting string into list</span>
    <span class="n">words_list</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    
    <span class="c1"># Removing empty strings and words shorter than the provided minimum length</span>
    <span class="n">words_list_cleaned</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">words_list</span> <span class="k">if</span> <span class="p">((</span><span class="n">i</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">min_length</span><span class="p">))]</span>
    
    <span class="k">return</span> <span class="n">words_list</span></div>

<div class="viewcode-block" id="get_html_clean_text"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.get_html_clean_text">[docs]</a><span class="k">def</span> <span class="nf">get_html_clean_text</span><span class="p">(</span><span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes html, extracts text, cleans it, and returns it as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">text</span> <span class="o">=</span> <span class="n">get_text_selectolax</span><span class="p">(</span><span class="n">html</span> <span class="o">=</span> <span class="n">html</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">html_text_cleaner</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">text</span></div>

<div class="viewcode-block" id="get_html_clean_words"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.get_html_clean_words">[docs]</a><span class="k">def</span> <span class="nf">get_html_clean_words</span><span class="p">(</span><span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes html, extracts text, cleans it, and returns words contained as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">text</span> <span class="o">=</span> <span class="n">get_html_clean_text</span><span class="p">(</span><span class="n">html</span> <span class="o">=</span> <span class="n">html</span><span class="p">)</span>
    <span class="n">words_list</span> <span class="o">=</span> <span class="n">get_words_list</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">words_list</span></div>




<div class="viewcode-block" id="list_remove_nones"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.list_remove_nones">[docs]</a><span class="k">def</span> <span class="nf">list_remove_nones</span><span class="p">(</span><span class="n">list_item</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes None items from list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">list_item</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">]</span></div>



<div class="viewcode-block" id="none_list_to_empty_list"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.none_list_to_empty_list">[docs]</a><span class="k">def</span> <span class="nf">none_list_to_empty_list</span><span class="p">(</span><span class="n">list_item</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Turns a list of None items into an empty list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Checking if object is a list</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">list_item</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Item must be a list&#39;</span><span class="p">)</span>
    
    <span class="c1"># Returning empty list if list is a list of Nones</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">((</span><span class="n">list_item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">list_item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">list_item</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;NaT&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">list_item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">list_item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pd</span><span class="o">.</span><span class="n">NaT</span><span class="p">)):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">()</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">list_item</span></div>

<div class="viewcode-block" id="nat_list_to_nones_list"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.nat_list_to_nones_list">[docs]</a><span class="k">def</span> <span class="nf">nat_list_to_nones_list</span><span class="p">(</span><span class="n">list_item</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces Numpy Not a Time (NaT) items in a list with Nones.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    
    <span class="c1"># Checking if object is a list</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">list_item</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Item must be a list&#39;</span><span class="p">)</span>
    
    
    <span class="c1"># Replacing NaTs with Nones</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">list_item</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">NaT</span><span class="p">):</span>
            <span class="n">new_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            
    <span class="c1"># If list is (now) empty, returns a None object</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">list_item</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>
    
    <span class="k">return</span> <span class="n">new_list</span></div>

<div class="viewcode-block" id="series_none_list_to_empty_lists"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.series_none_list_to_empty_lists">[docs]</a><span class="k">def</span> <span class="nf">series_none_list_to_empty_lists</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces None items in Pandas series with empty lists. To be use with pandas.apply().</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">none_list_to_empty_list</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">item</span></div>

<div class="viewcode-block" id="empty_list_to_none"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.empty_list_to_none">[docs]</a><span class="k">def</span> <span class="nf">empty_list_to_none</span><span class="p">(</span><span class="n">list_item</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces empty list with None object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Checking if item is a list object</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">list_item</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Item must be a list&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">list_item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">list_item</span></div>

<div class="viewcode-block" id="empty_set_to_none"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.empty_set_to_none">[docs]</a><span class="k">def</span> <span class="nf">empty_set_to_none</span><span class="p">(</span><span class="n">set_item</span><span class="p">:</span> <span class="nb">set</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces empty set with None object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">set_item</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Item must be a set&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">set_item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">set_item</span></div>

<div class="viewcode-block" id="empty_dict_to_none"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.empty_dict_to_none">[docs]</a><span class="k">def</span> <span class="nf">empty_dict_to_none</span><span class="p">(</span><span class="n">dict_item</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces empty dictionary with None object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">dict_item</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Item must be a dictionary&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dict_item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dict_item</span></div>

<div class="viewcode-block" id="empty_to_none"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.empty_to_none">[docs]</a><span class="k">def</span> <span class="nf">empty_to_none</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces empty object with None object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">empty_list_to_none</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">empty_set_to_none</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">empty_dict_to_none</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">item</span>
        
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">item</span></div>
    

<div class="viewcode-block" id="parse_data"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.parse_data">[docs]</a><span class="k">def</span> <span class="nf">parse_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ignore_case</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">stopwords</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;english&#39;</span><span class="p">,</span> <span class="n">retain_word_order</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parses string object based on an inputted datatype. Returns dictionary of parsed contents.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Checking if data is None object. If so, returns an empty dictionary.</span>
    <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>
    
    <span class="c1"># Checking the type of the data</span>
    <span class="n">data_var_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    
    <span class="n">output</span> <span class="o">=</span> <span class="kc">None</span>
    
    <span class="c1"># Processing data if datatype given is text</span>
    <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;text&#39;</span><span class="p">:</span>
        
        <span class="c1"># Checking type</span>
        <span class="k">if</span> <span class="n">data_var_type</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Text data must be inputted as a string&#39;</span><span class="p">)</span>
        
        <span class="c1"># Lowering case for data cleaning purposes</span>
        <span class="k">if</span> <span class="n">ignore_case</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        
        <span class="n">data_no_para</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        
        <span class="c1"># Parsing data</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;paragraphs&#39;</span><span class="p">:</span> <span class="n">text_splitter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">parse_by</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">),</span>
                <span class="s1">&#39;sentences&#39;</span><span class="p">:</span> <span class="n">sent_tokenize</span><span class="p">(</span><span class="n">data_no_para</span><span class="p">),</span>
                <span class="s1">&#39;phrases&#39;</span><span class="p">:</span> <span class="n">text_splitter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">parse_by</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="p">[</span>
                                                                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
                                                                            <span class="s1">&#39;(&#39;</span><span class="p">,</span>
                                                                            <span class="s1">&#39;)&#39;</span><span class="p">,</span>
                                                                            <span class="s1">&#39;[&#39;</span>
                                                                            <span class="s1">&#39;]&#39;</span>
                                                                            <span class="s1">&#39;}&#39;</span>
                                                                            <span class="s1">&#39;{&#39;</span>
                                                                            <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> 
                                                                            <span class="s1">&#39;/&#39;</span><span class="p">,</span> 
                                                                            <span class="s1">&#39;,&#39;</span><span class="p">,</span> 
                                                                            <span class="s1">&#39;;&#39;</span><span class="p">,</span>
                                                                            <span class="s1">&#39;:&#39;</span><span class="p">,</span>
                                                                            <span class="s1">&#39; - &#39;</span><span class="p">,</span>
                                                                            <span class="s1">&#39; -- &#39;</span><span class="p">]</span>
                                                                                <span class="p">),</span>
                <span class="s1">&#39;words&#39;</span><span class="p">:</span> <span class="n">word_tokenize</span><span class="p">(</span><span class="n">data_no_para</span><span class="p">)}</span>
<span class="c1">#             text_splitter(data, parse_by = &#39; &#39;, replace = [</span>
<span class="c1">#                                                                         &#39;\n&#39;,</span>
<span class="c1">#                                                                         &#39;(&#39;,</span>
<span class="c1">#                                                                         &#39;)&#39;,</span>
<span class="c1">#                                                                         &#39;[&#39;</span>
<span class="c1">#                                                                         &#39;]&#39;</span>
<span class="c1">#                                                                         &#39;}&#39;</span>
<span class="c1">#                                                                         &#39;{&#39;</span>
<span class="c1">#                                                                         &#39;\\&#39;, </span>
<span class="c1">#                                                                         &#39;/&#39;, </span>
<span class="c1">#                                                                         &#39;,&#39;, </span>
<span class="c1">#                                                                         &#39;;&#39;,</span>
<span class="c1">#                                                                         &#39;:&#39;,</span>
<span class="c1">#                                                                         &#39; - &#39;,</span>
<span class="c1">#                                                                         &#39; -- &#39;]</span>
<span class="c1">#                                                                                 ),</span>
<span class="c1">#                 }</span>
        
        
    <span class="c1"># Processing data if datatype given is html</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;html&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;web code&#39;</span><span class="p">):</span>
            
            <span class="c1"># Getting text if data is an html requests object</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="n">requests_html</span><span class="o">.</span><span class="n">HTMLResponse</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">text</span>
            
            <span class="c1"># Lowering case for data cleaning purposes</span>
            <span class="k">if</span> <span class="n">ignore_case</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            
            <span class="c1"># Parsing data</span>
            <span class="n">output</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">output</span><span class="p">[</span><span class="s1">&#39;tags&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">html_get_tags</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">output</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_html_clean_text</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">output</span><span class="p">[</span><span class="s1">&#39;words&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_html_clean_words</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">output</span><span class="p">[</span><span class="s1">&#39;element_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">text_splitter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">parse_by</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="c1"># Extracting words and removing stopwords</span>
    <span class="k">if</span> <span class="n">output</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;words&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output</span><span class="p">[</span><span class="s1">&#39;words&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">remove_stopwords</span><span class="p">(</span>
                                                <span class="n">words_list</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;words&#39;</span><span class="p">],</span>
                                                <span class="n">language</span> <span class="o">=</span> <span class="n">language</span><span class="p">,</span>
                                                <span class="n">stopwords_list</span> <span class="o">=</span> <span class="n">stopwords</span><span class="p">,</span>
                                                <span class="n">ignore_case</span> <span class="o">=</span> <span class="n">ignore_case</span><span class="p">,</span>
                                                <span class="n">retain_order</span> <span class="o">=</span> <span class="n">retain_word_order</span>
                                              <span class="p">)</span>
    
    <span class="k">return</span> <span class="n">output</span></div>

        

<div class="viewcode-block" id="parse_data_to_set"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.parse_data_to_set">[docs]</a><span class="k">def</span> <span class="nf">parse_data_to_set</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ignore_case</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parses string data object and returns a set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Parsing data</span>
    <span class="n">parsed_data</span> <span class="o">=</span> <span class="n">parse_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span> <span class="n">ignore_case</span> <span class="o">=</span> <span class="n">ignore_case</span><span class="p">)</span>
    
    <span class="c1"># Creating set from data.</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">parsed_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">parsed_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">parsed_data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">parsed_data</span></div>

    

<div class="viewcode-block" id="is_int"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.is_int">[docs]</a><span class="k">def</span> <span class="nf">is_int</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if a string can be converted successfully to an integer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">int</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="correct_int"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.correct_int">[docs]</a><span class="k">def</span> <span class="nf">correct_int</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a string to an integer if it can be converted successfully. Uses exception handling to avoid errors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">boolean</span> <span class="o">=</span> <span class="n">is_int</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">boolean</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="is_float"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.is_float">[docs]</a><span class="k">def</span> <span class="nf">is_float</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if a string can be converted successfully to a float.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="correct_float"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.correct_float">[docs]</a><span class="k">def</span> <span class="nf">correct_float</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a string to a float if it can be converted successfully. Uses exception handling to avoid errors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">boolean</span> <span class="o">=</span> <span class="n">is_float</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">boolean</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="date_checker"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.date_checker">[docs]</a><span class="k">def</span> <span class="nf">date_checker</span><span class="p">(</span><span class="n">date</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">print_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if a string is a date. If successful, returns a tuple containing result and the date&#39;s format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># defining formats</span>
    <span class="n">date_formats</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;%y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%m %Y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%m.%y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%m.%Y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%m/%y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%m/%Y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%m-%y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%m-%Y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y %m&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%y.%m&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y.%m&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%y/%m&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y/%m&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%y-%m&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y-%m&#39;</span><span class="p">,</span>
            <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%m-%y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.%m.%y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%m-%Y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.%m.%Y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%m-</span><span class="si">%d</span><span class="s1">-%y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%m.</span><span class="si">%d</span><span class="s1">.%y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%m-</span><span class="si">%d</span><span class="s1">-%Y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%m.</span><span class="si">%d</span><span class="s1">.%Y&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%y/%m/</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%y.%m.</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y.%m.</span><span class="si">%d</span><span class="s1">&#39;</span>
          <span class="p">]</span>
    
    <span class="n">date_format</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">date_formats</span><span class="p">:</span>

        <span class="c1"># using try-except to check for truth value</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">res</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">date_format</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">if</span> <span class="n">print_format</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Date format: &#39;</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">continue</span>
    
    <span class="k">return</span> <span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date_format</span><span class="p">)</span></div>

<div class="viewcode-block" id="is_date"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.is_date">[docs]</a><span class="k">def</span> <span class="nf">is_date</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">print_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if a string is a date.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">==</span> <span class="n">datetime</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input must be a string&#39;</span><span class="p">)</span>
        
    <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    
    <span class="n">date_result</span> <span class="o">=</span> <span class="n">date_checker</span><span class="p">(</span><span class="n">date</span> <span class="o">=</span> <span class="n">string</span><span class="p">,</span> <span class="n">print_format</span> <span class="o">=</span> <span class="n">print_format</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">date_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>

        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;T&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;t&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;: &#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;,&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;T&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;UTC&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;utc&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
                <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;t&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
                    <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;: &#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
                        <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;: &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s1">&#39;,&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
                            <span class="n">split</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">split</span><span class="p">)</span> <span class="o">&lt;=</span><span class="mi">2</span><span class="p">:</span>
                                <span class="n">string</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                                
                            
                        <span class="k">elif</span> <span class="s1">&#39; &#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
                            <span class="n">split</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">split</span><span class="p">)</span> <span class="o">&lt;=</span><span class="mi">2</span><span class="p">:</span>
                                <span class="n">string</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        
        <span class="n">date_result</span> <span class="o">=</span> <span class="n">date_checker</span><span class="p">(</span><span class="n">date</span> <span class="o">=</span> <span class="n">string</span><span class="p">,</span> <span class="n">print_format</span> <span class="o">=</span> <span class="n">print_format</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">date_result</span></div>

<div class="viewcode-block" id="str_to_date"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.str_to_date">[docs]</a><span class="k">def</span> <span class="nf">str_to_date</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">print_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts date strings to datetime objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">==</span> <span class="n">datetime</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input must be a string&#39;</span><span class="p">)</span>
    
    <span class="n">result</span> <span class="o">=</span> <span class="n">is_date</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">print_format</span> <span class="o">=</span> <span class="n">print_format</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input is not a valid date&#39;</span><span class="p">)</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input is not a valid date&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="time_checker"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.time_checker">[docs]</a><span class="k">def</span> <span class="nf">time_checker</span><span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">print_format</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if a string is a time.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># defining formats</span>
    <span class="n">time_formats</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;%I%p&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%H%M&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%H %M&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%H/%M&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%H.%M&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%H:%M&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%H, %M&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%I%p%M&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%I%p %M&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%I%p, %M&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%H/%M/%S&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%H.%M.%S&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%H:%M:%S&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%H, %M, %S&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%H %M %S&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%I%p%M%S&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%I%p/%M/%S&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%I%p.%M.%S&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%I%p:%M:%S&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%I%p, %M, %S&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%I%p %M %S&#39;</span>
          <span class="p">]</span>
    
    <span class="n">time_format</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        
        <span class="c1"># Checking string against all time formats given</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">time_formats</span><span class="p">:</span>

            <span class="c1"># using try-except to check for truth value</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">time_res</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">time_res</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">time_format</span> <span class="o">=</span> <span class="n">i</span>
                    <span class="k">if</span> <span class="n">print_format</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time format: &#39;</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
                    <span class="k">break</span>
                    
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">time_format</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                    <span class="k">continue</span>

            <span class="k">except</span><span class="p">:</span>
                <span class="n">time_format</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">time_res</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">continue</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="n">time_format</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">time_res</span> <span class="o">=</span> <span class="kc">False</span>
    
    <span class="k">return</span> <span class="p">(</span><span class="n">time_res</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">time_format</span><span class="p">)</span></div>

<div class="viewcode-block" id="utc_checker"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.utc_checker">[docs]</a><span class="k">def</span> <span class="nf">utc_checker</span><span class="p">(</span><span class="n">utc_offset</span><span class="p">,</span> <span class="n">print_format</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if a string is in UTC datetime format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># defining formats</span>
    <span class="n">utc_formats</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;%z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Z %z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Z%z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%:z&#39;</span>
          <span class="p">]</span>
    
    <span class="n">utc_format</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">utc_offset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        
        <span class="c1"># Checking string against all UTC datetime formats given</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">utc_formats</span><span class="p">:</span>

            <span class="c1"># using try-except to check for truth value</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">utc_res</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">utc_offset</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">utc_res</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">utc_format</span> <span class="o">=</span> <span class="n">i</span>
                    <span class="k">if</span> <span class="n">print_format</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;UTC format: &#39;</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">utc_format</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                    <span class="k">continue</span>

            <span class="k">except</span><span class="p">:</span>
                <span class="n">utc_format</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">utc_res</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">continue</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="n">utc_format</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">utc_res</span> <span class="o">=</span> <span class="kc">False</span>
    
    <span class="k">return</span> <span class="p">(</span><span class="n">utc_res</span><span class="p">,</span> <span class="n">utc_offset</span><span class="p">,</span> <span class="n">utc_format</span><span class="p">)</span></div>

<div class="viewcode-block" id="is_time"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.is_time">[docs]</a><span class="k">def</span> <span class="nf">is_time</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">print_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if a string is a time, accounting for UTC formatting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">==</span> <span class="n">datetime</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input must be a string&#39;</span><span class="p">)</span>
    
    <span class="c1"># Stripping leading and trailing whitespaces</span>
    <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    
    <span class="c1"># Checking if the string is a time using time checker</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">string</span>
    <span class="n">utc_offset</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">time_res</span> <span class="o">=</span> <span class="n">time_checker</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">print_format</span> <span class="o">=</span> <span class="n">print_format</span><span class="p">)</span>
    
    <span class="c1"># If the result is False, checking alternative formats.</span>
    <span class="k">if</span> <span class="n">time_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;T&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;t&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;: &#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;,&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;T&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;UTC&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;utc&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
                <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;t&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
                    <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;: &#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
                        <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;: &#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s1">&#39;,&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
                            <span class="n">split</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">split</span><span class="p">)</span> <span class="o">&lt;=</span><span class="mi">2</span><span class="p">:</span>
                                <span class="n">string</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                            
                        <span class="k">elif</span> <span class="s1">&#39; &#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
                            <span class="n">split</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">split</span><span class="p">)</span> <span class="o">&lt;=</span><span class="mi">2</span><span class="p">:</span>
                                <span class="n">string</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    
        <span class="n">time</span> <span class="o">=</span> <span class="n">string</span>
        <span class="n">utc_offset</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="n">time_res</span> <span class="o">=</span> <span class="n">time_checker</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">print_format</span> <span class="o">=</span> <span class="n">print_format</span><span class="p">)</span>
    
    
    <span class="c1"># If the result is False, checking alternative formats.</span>
    <span class="k">if</span> <span class="n">time_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;utc&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
        
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;UTC&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">and</span> <span class="p">((</span><span class="s1">&#39;+&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)):</span>
                <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;UTC&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;UTC&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
                <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;UTC&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;utc&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">and</span> <span class="p">((</span><span class="s1">&#39;+&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)):</span>
                <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;utc&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;utc&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
                <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;utc&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="s1">&#39;+&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
                    <span class="n">split</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
                    <span class="n">time</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">utc_offset</span> <span class="o">=</span> <span class="s1">&#39;+&#39;</span> <span class="o">+</span> <span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

            <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
                    <span class="n">split</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
                    <span class="n">time</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">utc_offset</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">string</span>
            <span class="n">utc_offset</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    
    
    <span class="c1"># If the result is False, checking alternative formats and UTC formatting.</span>
    
    <span class="n">time_res</span> <span class="o">=</span> <span class="n">time_checker</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">print_format</span> <span class="o">=</span> <span class="n">print_format</span><span class="p">)</span>
    <span class="n">utc_res</span> <span class="o">=</span> <span class="n">utc_checker</span><span class="p">(</span><span class="n">utc_offset</span> <span class="o">=</span> <span class="n">utc_offset</span><span class="p">,</span> <span class="n">print_format</span> <span class="o">=</span> <span class="n">print_format</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">time_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">new_time_str</span> <span class="o">=</span> <span class="n">time_res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_time_str</span> <span class="o">=</span> <span class="n">time</span>
    
    <span class="k">if</span> <span class="n">utc_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">new_utc_res</span> <span class="o">=</span> <span class="n">utc_res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_utc_res</span> <span class="o">=</span> <span class="n">utc_offset</span>
    
    <span class="n">new_str</span> <span class="o">=</span> <span class="n">new_time_str</span> <span class="o">+</span> <span class="n">new_utc_res</span>
    <span class="n">new_format</span> <span class="o">=</span> <span class="n">time_res</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">utc_res</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">time_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">utc_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">new_str</span><span class="p">,</span> <span class="n">new_format</span><span class="p">)</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">new_str</span><span class="p">,</span> <span class="n">new_format</span><span class="p">)</span></div>

<div class="viewcode-block" id="str_to_time"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.str_to_time">[docs]</a><span class="k">def</span> <span class="nf">str_to_time</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">print_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts time strings to time objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">==</span> <span class="n">datetime</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input must be a string&#39;</span><span class="p">)</span>
    
    <span class="c1"># Checking if the string is a time</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">is_time</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">print_format</span> <span class="o">=</span> <span class="n">print_format</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input is not a valid time&#39;</span><span class="p">)</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input is not a valid time&#39;</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="is_datetime"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.is_datetime">[docs]</a><span class="k">def</span> <span class="nf">is_datetime</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">print_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if string is a date, time, or date-time.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">==</span> <span class="n">datetime</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input must be a string&#39;</span><span class="p">)</span>
    
    <span class="n">input_string</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    
    <span class="c1"># Checking if the string is a date or time</span>
    <span class="n">date_res</span> <span class="o">=</span> <span class="n">is_date</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">print_format</span><span class="p">)</span>
    <span class="n">time_res</span> <span class="o">=</span> <span class="n">is_time</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">print_format</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">date_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">time_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">date_res</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">date_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">time_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">time_res</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">date_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">time_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">date_res</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">input_string</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    
    
    
    <span class="c1"># If the result is False, checking alternative formats and UTC formatting.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">date_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">time_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;T&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;t&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;: &#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;,&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>

            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;T&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
                <span class="n">split</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
                <span class="n">date_string</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">time_string</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;T&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
                    <span class="n">split</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
                    <span class="n">date_string</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">time_string</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

                <span class="k">else</span><span class="p">:</span>
                    
                    
                    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;,&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
                        <span class="n">split</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                        <span class="n">date_string</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="n">time_string</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

                    <span class="k">else</span><span class="p">:</span>
                        
                        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;: &#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
                            <span class="n">split</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                            <span class="n">date_string</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                            <span class="n">time_string</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        
                        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
                            <span class="n">split</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                            <span class="n">date_string</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                            <span class="n">time_string</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">date_string</span> <span class="o">=</span> <span class="n">string</span>
            <span class="n">time_string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="n">date_res</span> <span class="o">=</span> <span class="n">is_date</span><span class="p">(</span><span class="n">date_string</span><span class="p">,</span> <span class="n">print_format</span><span class="p">)</span>
        <span class="n">time_res</span> <span class="o">=</span> <span class="n">is_time</span><span class="p">(</span><span class="n">time_string</span><span class="p">,</span> <span class="n">print_format</span><span class="p">)</span>
    
    
    
    
    <span class="k">if</span> <span class="p">(</span><span class="n">date_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">time_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">new_str</span> <span class="o">=</span> <span class="n">date_res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">time_res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">new_format</span> <span class="o">=</span> <span class="n">date_res</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">time_res</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">new_str</span><span class="p">,</span> <span class="n">new_format</span><span class="p">)</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">input_string</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="is_date_or_time"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.is_date_or_time">[docs]</a><span class="k">def</span> <span class="nf">is_date_or_time</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">print_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if string is a date or time.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">==</span> <span class="n">datetime</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input must be a string&#39;</span><span class="p">)</span>
    
    <span class="n">dt_res</span> <span class="o">=</span> <span class="n">is_datetime</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">print_format</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">dt_res</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">date_res</span> <span class="o">=</span> <span class="n">is_date</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">print_format</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">time_res</span> <span class="o">=</span> <span class="n">is_time</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">print_format</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">date_res</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">time_res</span> <span class="o">=</span> <span class="kc">True</span>
    
    <span class="k">if</span> <span class="n">print_format</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Is date-time: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dt_res</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Contains date: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">date_res</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Contains time: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_res</span><span class="p">))</span>
        
    <span class="k">if</span> <span class="p">(</span><span class="n">date_res</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">time_res</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">dt_res</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="str_to_datetime"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.str_to_datetime">[docs]</a><span class="k">def</span> <span class="nf">str_to_datetime</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">print_format</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts date, time, or datetime strings to datetime objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">==</span> <span class="n">datetime</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input must be a string&#39;</span><span class="p">)</span>
    
    <span class="c1"># Checking if the item is a datetime</span>
    <span class="n">dt_result</span> <span class="o">=</span> <span class="n">is_datetime</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">print_format</span> <span class="o">=</span> <span class="n">print_format</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">dt_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">dt_result</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dt_result</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="n">date_result</span> <span class="o">=</span> <span class="n">is_date</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">print_format</span> <span class="o">=</span> <span class="n">print_format</span><span class="p">)</span>
        <span class="n">time_result</span> <span class="o">=</span> <span class="n">is_time</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">print_format</span> <span class="o">=</span> <span class="n">print_format</span><span class="p">)</span>
    
        <span class="k">if</span> <span class="p">(</span><span class="n">date_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">time_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">new_str</span> <span class="o">=</span> <span class="n">date_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">time_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">new_format</span> <span class="o">=</span> <span class="n">date_result</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">time_result</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">new_str</span><span class="p">,</span> <span class="n">new_format</span><span class="p">)</span>

            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input is not a valid date-time&#39;</span><span class="p">)</span>
    
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">date_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date_result</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">date_result</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

                <span class="k">except</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input is not a valid date-time&#39;</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">time_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">time_result</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">time_result</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input is not a valid date-time&#39;</span><span class="p">)</span>
                
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input is not a valid date-time&#39;</span><span class="p">)</span></div>
    

<div class="viewcode-block" id="list_to_datetimes"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.list_to_datetimes">[docs]</a><span class="k">def</span> <span class="nf">list_to_datetimes</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a list of date or time strings into a list of datetime objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">))</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">item</span>
        
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">item</span></div>

<div class="viewcode-block" id="series_to_datetimes"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.series_to_datetimes">[docs]</a><span class="k">def</span> <span class="nf">series_to_datetimes</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a Pandas series of dates into a series of datetime objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">str_to_datetime</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">item</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">object</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">item</span>
        
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">item</span></div>

<div class="viewcode-block" id="correct_series_of_lists"><a class="viewcode-back" href="../../../ida.core.html#ida.core.cleaners.correct_series_of_lists">[docs]</a><span class="k">def</span> <span class="nf">correct_series_of_lists</span><span class="p">(</span><span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a Pandas series of strings representing lists into a series of lists.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">series</span><span class="p">)</span> <span class="o">!=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Series must be a pandas Series object&#39;</span><span class="p">)</span>
    
    <span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>
        
        <span class="n">item</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;{&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
            <span class="n">item</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">item</span><span class="p">]</span>

        <span class="n">series</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>
    
    <span class="k">return</span> <span class="n">series</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Jamie Hancock.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>